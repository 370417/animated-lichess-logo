<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Animated Lichess logo</title>
  </head>
  <body>
    <p>
      I’m remaking the
      <a
        href="https://lichess.org/@/user370417/blog/the-lichess-logo-animated/Df4SWGyX"
        >Lichess logo animation</a
      >
      to make it work outside the browser. I thought it might be nice to explain
      what I’m doing as I go along, hence this blog post.
    </p>
    <h2>Planning</h2>
    <p>This is the Inkscape document I’m using to plan out the animation.</p>
    <img src="src/inkscape/logo-inkscape.svg" width="200px" height="200px" />
    <h2>Drawing the paths</h2>
    <p>
      Step one is drawing the paths we want to animate. There are built-in
      functions for drawing bézier curves, but they can’t draw partial paths.
      That’s something we’ll need to implement ourselves.
    </p>
    <div id="drawPath">
      <div class="output"></div>
      <div class="controls">
        <label for="drawPathI">Iterations</label>
        <input type="range" name="drawPathI" id="drawPathI" max="20" />
        <span class="state-display" data-state-provider="drawPathFrame"></span>
        Length:
        <span
          class="state-display"
          data-state-provider="drawPathCurveLength"
        ></span>
      </div>
    </div>
    <h2>Basic animation</h2>
    <div id="basicAnimation">
      <div class="output"></div>
      <div class="controls">
        <label for="basicAnimationFrame">Length</label>
        <input
          type="range"
          name="basicAnimationFrame"
          id="basicAnimationFrame"
          max="100"
        />
        <span
          class="state-display"
          data-state-provider="basicCurveLength"
        ></span>
        <input
          type="checkbox"
          name="basicAnimationPlay"
          id="basicAnimationPlay"
        />
      </div>
    </div>
    <h2>Lerp animation</h2>
    <div id="lerpAnimation">
      <div class="output"></div>
      <div class="controls">
        <label for="lerpAnimationFrame">Length</label>
        <input
          type="range"
          name="lerpAnimationFrame"
          id="lerpAnimationFrame"
          max="100"
        />
        <span
          class="state-display"
          data-state-provider="lerpCurveLength"
        ></span>
        <input
          type="checkbox"
          name="lerpAnimationPlay"
          id="lerpAnimationPlay"
        />
      </div>
    </div>
    <h2>Mask animation</h2>
    <div id="maskAnimation">
      <div class="output"></div>
      <div class="controls">
        <label for="maskAnimationFrame">Length</label>
        <input
          type="range"
          name="maskAnimationFrame"
          id="maskAnimationFrame"
          max="100"
        />
        <span
          class="state-display"
          data-state-provider="maskCurveLength"
        ></span>
        <input
          type="checkbox"
          name="maskAnimationPlay"
          id="maskAnimationPlay"
        />
        <br />
        <label for="maskMaskToggle">Mask</label>
        <input type="checkbox" name="maskMaskToggle" id="maskMaskToggle" />
      </div>
    </div>
    <h2>Edge vectors</h2>
    <ul>
      <li>
        Use tangents instead of normals in planning because they come with
        direction.
      </li>
      <li>
        Calculate deltas (approximation of derivative) of path positions. Each
        delta is a vec2.
      </li>
      <li>
        Actually we might want cumulative delta. That's just the normal
        positions minus the position of the start point.
      </li>
      <li>
        Figure out what linear transform is required to get the natural
        start/end deltas to match the desired start/end tangents. Make sure
        tangents have same length as start/end deltas for this.
      </li>
      <li>ignore above</li>
      <li>
        It's like linear interpolation, but we use the path data to interpolate
        instead.
      </li>
      <li>
        So with lerp, to get a value between start and end, you solve a linear
        equation. For path data interpolation, you look up the value of the path
        at the given time and see where it is at compared to the start and end
        of the path.
      </li>
      <li>
        To implement this, you can normalize the path points to start at 0 and
        end at 1, then interpolation is easy.
      </li>
    </ul>
    <div id="edgeVec">
      <div class="output"></div>
      <div class="controls">
        <label for="edgeVecFrame">Length</label>
        <input type="range" name="edgeVecFrame" id="edgeVecFrame" max="100" />
        <span class="state-display" data-state-provider="edgeVecLength"></span>
        <input type="checkbox" name="edgeVecPlay" id="edgeVecPlay" />
        <br />
        <label for="edgeVecMaskToggle">Mask</label>
        <input
          type="checkbox"
          name="edgeVecMaskToggle"
          id="edgeVecMaskToggle"
        />
      </div>
    </div>
    <h2>Projection of edge vectors onto envelope</h2>
    <h2>Filling the envelope</h2>
    <svg width="0" height="0">
      <mask id="logo"></mask>
    </svg>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
